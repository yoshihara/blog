machine:
  environment:
    GOROOT: ""
    PATH: "/usr/local/go/bin:~/.go_workspace/bin:${PATH}"
    GOPATH: "${HOME}/.go_workspace"
    ROOT_PATH: "${GOPATH}/src/github.com/${CIRCLE_PROJECT_USERNAME}/${CIRCLE_PROJECT_REPONAME}"
dependencies:
  override:
    - mkdir -p ${GOPATH}/src/github.com/${CIRCLE_PROJECT_USERNAME}
    - ln -s ${HOME}/${CIRCLE_PROJECT_REPONAME} ${ROOT_PATH}
    - go get -u github.com/kardianos/govendor
    - govendor get github.com/gohugoio/hugo
    - go install github.com/gohugoio/hugo

test:
  override:
    - echo "no test"

deployment:
  production:
    branch: master
    commands:
      - ./bin/format_esa_md_for_hugo.sh
      - hugo
      - aws s3 sync public s3://blog.bomberowl.org/ --delete
